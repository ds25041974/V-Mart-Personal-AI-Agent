<!DOCTYPE html>
<html>
<head>
    <title>UI Test - Standalone</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .test-section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h2 { color: #333; border-bottom: 2px solid #4285f4; padding-bottom: 10px; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: Arial; }
        button { padding: 10px 20px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #357ae8; }
        .log { background: #f9f9f9; border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        input[type="file"] { margin: 10px 0; }
        .file-list { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üß™ V-Mart AI Agent - UI Component Test</h1>
    <p>This standalone page tests if the UI handlers work independently of the server.</p>

    <div id="console-log" class="log">
        <div class="info">üìã Console Log (watch for events here):</div>
    </div>

    <!-- TEST 1: CHAT SEND -->
    <div class="test-section">
        <h2>TEST 1: Chat Send Button & Enter Key</h2>
        <textarea id="prompt-input" placeholder="Type a message and press Enter or click Send..." rows="3"
            onkeydown="if(event.key==='Enter' && !event.shiftKey){
                event.preventDefault();
                document.getElementById('send-btn').click();
                logToConsole('‚úÖ Enter key triggered!', 'success');
            }"></textarea>
        <button id="send-btn" type="button" onclick="
            logToConsole('üî• Send button clicked!', 'success');
            const msg = document.getElementById('prompt-input').value.trim();
            if(msg) {
                logToConsole('üì§ Message: ' + msg, 'info');
                document.getElementById('chat-output').innerHTML += '<div><strong>You:</strong> ' + msg + '</div>';
                document.getElementById('prompt-input').value = '';
                logToConsole('‚úÖ Message sent successfully!', 'success');
            } else {
                logToConsole('‚ùå Empty message!', 'error');
            }
        ">Send</button>
        <div id="chat-output" style="background:#f0f0f0; padding:10px; margin:10px 0; min-height:100px; border-radius:4px;">
            <div style="color:#999;">Messages will appear here...</div>
        </div>
    </div>

    <!-- TEST 2: FILE BROWSE -->
    <div class="test-section">
        <h2>TEST 2: File Browse (Single & Multiple)</h2>
        <input type="file" id="file-upload-input" multiple 
            accept=".txt,.md,.py,.js,.json,.csv,.pdf"
            style="display:none;"
            onchange="
                logToConsole('üì• Files selected: ' + this.files.length, 'success');
                handleFileSelection(this.files);
            ">
        <button id="browse-btn" type="button" onclick="
            logToConsole('üîò Browse button clicked!', 'success');
            document.getElementById('file-upload-input').click();
        ">üìÇ Browse Files</button>
        <div id="selected-files-info" class="file-list" style="display:none;"></div>
    </div>

    <!-- TEST 3: PATH BROWSE -->
    <div class="test-section">
        <h2>TEST 3: Path/Folder Browse</h2>
        <input type="file" id="path-browser" webkitdirectory directory multiple 
            style="display:none;"
            onchange="
                logToConsole('üìÅ Folder selected with ' + this.files.length + ' files', 'success');
                handlePathSelection(this.files);
            ">
        <button id="browse-path-btn" type="button" onclick="
            logToConsole('üîò Path browse button clicked!', 'success');
            document.getElementById('path-browser').click();
        ">üìÅ Browse Folder</button>
        <div id="path-info" class="file-list" style="display:none;"></div>
    </div>

    <script>
        // Logging function
        function logToConsole(message, type = 'info') {
            const log = document.getElementById('console-log');
            const time = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            log.innerHTML += `<div class="${className}">[${time}] ${message}</div>`;
            log.scrollTop = log.scrollHeight;
            console.log(message); // Also log to browser console
        }

        // File selection handler
        function handleFileSelection(files) {
            logToConsole('üîß handleFileSelection() called', 'info');
            if (files.length === 0) {
                logToConsole('‚ùå No files selected', 'error');
                return;
            }

            let html = '<h3>üìÇ Selected Files (' + files.length + '):</h3><ul>';
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const size = (file.size / 1024).toFixed(2) + ' KB';
                html += `<li><strong>${file.name}</strong> - ${size} - ${file.type || 'Unknown type'}</li>`;
            }
            html += '</ul>';
            
            const container = document.getElementById('selected-files-info');
            container.innerHTML = html;
            container.style.display = 'block';
            
            logToConsole('‚úÖ File list displayed!', 'success');
        }

        // Path selection handler
        function handlePathSelection(files) {
            logToConsole('üîß handlePathSelection() called', 'info');
            if (files.length === 0) {
                logToConsole('‚ùå No folder selected', 'error');
                return;
            }

            const file = files[0];
            let folderPath = file.webkitRelativePath || file.path || '';
            const folderName = folderPath.split('/')[0] || 'Unknown';
            
            let html = `<h3>üìÅ Selected Folder: "${folderName}"</h3>`;
            html += `<p>Contains ${files.length} files</p>`;
            html += `<p><em>Note: For security, browsers don't reveal the full system path.</em></p>`;
            
            const container = document.getElementById('path-info');
            container.innerHTML = html;
            container.style.display = 'block';
            
            logToConsole(`‚úÖ Folder "${folderName}" with ${files.length} files!`, 'success');
        }

        // Expose functions globally
        window.handleFileSelection = handleFileSelection;
        window.handlePathSelection = handlePathSelection;

        // Initial log
        logToConsole('üöÄ Test page loaded successfully!', 'success');
        logToConsole('‚ÑπÔ∏è  Test each feature and watch the logs above', 'info');
    </script>
</body>
</html>
